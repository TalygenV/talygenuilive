(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CRMManageContract"],{"9c5f":function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("section",{staticClass:"main-content"},[e("loader",{attrs:{"is-visible":t.isLoading}}),e("div",{attrs:{id:"divMainLeadData"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12 padding-t_8"},[e("div",{staticClass:"theme-primary partition-full"},[e("span",{staticClass:"p-name text-white"},[t._v(t._s(t.$t("ManageContracts")))])])])]),e("div",{staticClass:"border p-3"},[e("Form",{ref:"form"},[e("dynamic-form",{ref:"StageForm",attrs:{lang:"en",buttons:t.buttons,schema:t.FormSchema},on:{OnSubmit:t.onSubmit}}),e("div",{staticClass:"col-lg-6"},[e("div",{staticClass:"py-2"},[e("small",[e("span",{staticClass:"text-danger"},[t._v(" "+t._s(t.$t("MandatoryString")))])])])])],1)],1)])],1)},o=[],i=e("c7eb"),r=e("1da1"),s=(e("d3b7"),e("159b"),e("b0c0"),e("e9c4"),e("9769")),c={data:function(){return{isLoading:!1,contractID:this.$route.params.id,userId:null,compnayId:null,FormSchema:[],buttons:[{type:"submit",class:"btn btn-success save",text:"<i class='fa fa-save pr-2'></i>Submit"},{type:"button",class:"btn btn-danger",text:"<i class='fa fa-close pr-2'></i>Cancel",onClick:this.onCancel}]}},created:function(){this.userId=this.GetUserInfo.ID,this.companyId=this.GetUserInfo.CompanyId,this.FetchData()},methods:{onCancel:function(){this.$router.push({name:"Contract"})},onSearch:function(t,a,e){var n=this;n.searchSelectData(e,n,a)},searchSelectData:function(t,a,e){this.ShowSearchData(t,a,e)},ShowSearchData:function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(a,e,n){var o,r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=this,r="id=&&moduleName=CRM&type=ACCOUNTS&search=".concat(a,"&refId="),"undefined"==typeof n&&(n=0),n.config.options=[],t.next=6,s["a"].getDDLData(r).then((function(t){t.data&&(o.JsonObj=t.data,null!=o.JsonObj&&(t.data.DATA.forEach((function(t){var a={value:t.value,name:t.name};n.config.options.push(a)})),o.$refs.StageForm.UpdateKeyValue()))}));case 6:case"end":return t.stop()}}),t,this)})));function a(a,e,n){return t.apply(this,arguments)}return a}(),FetchData:function(){var t=this;t.isLoading=!0;var a="id=".concat(t.$route.params.id,"&moduleName=CRM&subModuleCode=CRM_CONTRACTS&langCode=en");s["a"].getFormLayout(a).then((function(a){t.isLoading=!1,t.FormSchema=t.$refs.StageForm.ConvertCustomFieldIntoDynamicFormObj(a.data.data),t.FormSchema.forEach((function(a,e){a.Data.forEach(function(){var a=Object(r["a"])(Object(i["a"])().mark((function a(e,n){return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:"account_id"==e.name&&(e.config.onSearchChange=t.onSearch),e.config.onChange=t.onChangeEventForFields;case 2:case"end":return a.stop()}}),a)})));return function(t,e){return a.apply(this,arguments)}}())}))}))},onSubmit:function(t,a){var e=this,n=this;n.$refs.form.validate().then((function(t){if(t){var a=n.$refs.StageForm.ConvertDynamicFormObjToCustomFieldObj(n.FormSchema);a.forEach((function(t){"created_by"==t.field_name&&(t.field_value=n.userId),"modified_by"==t.field_name&&(t.field_value=n.userId),"company_id"==t.field_name&&(t.field_value=n.companyId),"contract_id"==t.field_name&&(t.field_value=n.contractID),"created_at"==t.field_name&&(t.field_value=n.$options.filters.formatDate(new Date)),"modified_at"==t.field_name&&(t.field_value=n.$options.filters.formatDate(new Date))}));var o={data:a},i=JSON.stringify(o);s["a"].PostContract(i).then((function(t){n.isLoading=!1,"1"==t.data[0].Code?(n.contactId>0?n.ShowAlert(n.$t("UpdatedSuccess",[n.$t("Contacts")]),"Success",!0,n.$t("Alert")):n.ShowAlert(n.$t("AddedSuccess",[n.$t("Contacts")]),"Success",!0,n.$t("Alert")),e.$router.push({name:"Contract"})):"-1"==t.data[0].Code?n.ShowAlert(n.$t("AlreadyExists",[n.$t("Email")]),"warning",!0,n.$t("Alert")):n.ShowAlert(n.$t("AddedError",[n.$t("Contacts")]),"error",!0,n.$t("Alert"))}))}}))}}},d=c,l=e("2877"),u=Object(l["a"])(d,n,o,!1,null,null,null);a["default"]=u.exports}}]);
//# sourceMappingURL=CRMManageContract.js.map